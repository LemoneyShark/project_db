<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Company List with Live Search</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .search-box {
            margin-bottom: 20px;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        ul {
            list-style-type: none;
            padding: 0;
        }

        li {
            padding: 10px;
            border: 1px solid #ddd;
            margin-bottom: 5px;
            border-radius: 4px;
        }
    </style>
</head>
<body>

    <h1>Company List</h1>
    
    <div class="search-box">
        <input type="text" id="searchInput" placeholder="Search for a company...">
    </div>

    <ul id="companyList"></ul> <!-- แสดงรายชื่อบริษัทที่นี่ -->

    <script>
        // ฟังก์ชันสำหรับดึงข้อมูลจาก API
        async function fetchCompanies() {
            try {
                const response = await fetch('/companies');
                const result = await response.json();

                // แสดงบริษัททั้งหมด
                displayCompanies(result.data);
            } catch (error) {
                console.error('Error fetching companies:', error);
            }
        }

        // ฟังก์ชันสำหรับแสดงรายชื่อบริษัททั้งหมด
        function displayCompanies(companies) {
            const companyList = document.getElementById("companyList");
            companyList.innerHTML = ''; // เคลียร์รายการเดิมก่อน

            companies.forEach(company => {
                const li = document.createElement('li');
                li.textContent = company.name;
                companyList.appendChild(li);
            });
        }

        // เรียกใช้ฟังก์ชัน fetchCompanies เมื่อโหลดหน้าเสร็จ
        window.onload = fetchCompanies;

        // ฟังก์ชันสำหรับค้นหา
        document.getElementById('searchInput').addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            const filteredCompanies = Array.from(document.querySelectorAll('#companyList li')).filter(li => 
                li.textContent.toLowerCase().includes(searchTerm)
            );

            // แสดงเฉพาะบริษัทที่ค้นหาเจอ
            document.querySelectorAll('#companyList li').forEach(li => {
                li.style.display = 'none'   ; // ซ่อนทุกบริษัท
            });
            filteredCompanies.forEach(li => {
                li.style.display = 'block'; // แสดงบริษัทที่ค้นเจอ
            });
        });
    </script>

</body>
</html>
